model:
  name: bigcode/starcoder2-3b
  tokenizer_name: bigcode/starcoder2-3b
  trust_remote_code: true
  use_4bit: true
  use_8bit: false
  use_bf16: true
  use_lora: true
  lora:
    r: 16
    lora_alpha: 32
    target_modules:
    - c_attn
    - c_proj
    - c_fc
    lora_dropout: 0.05
    bias: none
  max_position_embeddings: 4096
  max_new_tokens: 512
  vocab_size_override: null
training:
  base_learning_rate: 2e-4
  warmup_ratio: 0.1
  warmup_steps_min: 10
  warmup_steps_max: 1000
  weight_decay: 0.01
  batch_size_reference: 4
  batch_size_large: 4
  batch_size_medium: 2
  batch_size_small: 1
  num_workers: 4
  num_workers_min: 1
  num_workers_max: 8
  pin_memory: true
  gradient_accumulation_steps: 4
  max_grad_norm: 1.0
  use_mixed_precision: true
  autocast_dtype: bfloat16
  use_gradient_checkpointing: true
  validation_split: 0.1
  patience: 3
  min_delta: 0.0001
  seed: 42
epoch_calculation:
  target_tokens: 20000000
  min_epochs: 3
  max_epochs: 10
  override_min_warmup: true
  min_sequences_threshold: 5
  fallback_epochs_tiny: 10
  fallback_epochs_small: 8
  fallback_epochs_medium: 6
  fallback_epochs_large: 5
  fallback_epochs_huge: 4
hardware_monitoring:
  collection_interval_seconds: 5
  gpu_memory_threshold_large_gb: 7.0
  gpu_memory_threshold_medium_gb: 4.0
  gpu_memory_threshold_small_gb: 2.0
logging:
  track_loss_history: true
  track_grad_norms: true
  track_lr_schedule: true
  track_hardware: true
  track_per_step_metrics: false
  include_loss_history: true
  include_min_max_stats: true
  include_hardware_peak: true
  include_epoch_summary: true
  track_overfitting_gap: true
  track_adapter_params: true
  include_model_info: true
evaluation:
  run_behavioral_eval: true
  eval_every_n_epochs: 1
  behavioral_test_prompts:
  - fn process
  - impl
  - pub struct
  - pub enum
  - async fn
  - '#[derive('
  - match
  - Result<
  - Option<
  - fn new() -> Self
  - "where\n    T:"
  - Box<dyn
  - Arc<Mutex<
  - 'use std::'
  - 'use crate::'
  - mod
  - pub mod
  - impl Error for
  - .map_err(
  - '?'
  - '#[cfg(test)]'
  - mod tests {
  - '#[test]'
  - assert_eq!(
  - impl Transaction
  - struct Energy
  - fn validate
  - async fn handle
  eval_max_length: 150
  eval_num_return_sequences: 1
  eval_temperature: 0.7
  eval_top_p: 0.95
model_saving:
  save_final_model: true
  save_best_model: true
  save_ckpt_every_n_epochs: 1
  save_adapter_only: false
  output_dir: models/the-block-rust-model
  use_curriculum: true
  weight_by_recency: true
  weight_by_directory: false
  weight_by_author: false
  pack_sequences: false
  ignore_patterns:
  - target/
  - '*.rlib'
  - '*.rmeta'
  - '*.so'
  - '*.dylib'
  - '*.dll'
  - Cargo.lock
  - '*.exe'
  - '*.pdb'
  - '*.profraw'
  - '*.profdata'
  boost_patterns:
  - src/lib.rs
  - src/main.rs
  - src/**/*.rs
  - tests/**/*.rs
  - benches/**/*.rs
  - examples/**/*.rs
  - Cargo.toml
output:
  manifest_file: MANIFEST_RUST.json
  report_file: training_report_rust.json
  include_generated_samples: true
data:
  sequences_file: data/token_sequences_rust.json
  format: json
  eval_split: 0.1
  ignore_patterns:
  - target/
  - "*.rlib"
  - "*.rmeta"
  - Cargo.lock
